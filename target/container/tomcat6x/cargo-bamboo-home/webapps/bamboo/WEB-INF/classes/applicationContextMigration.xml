<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:plugin="http://atlassian.com/schema/spring/plugin"
       xsi:schemaLocation="
       http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd
       http://atlassian.com/schema/spring/plugin http://atlassian.com/schema/spring/plugin.xsd">

  <bean id="xmlMigrator" parent="txReadWriteProxy">
    <property name="target">
      <bean class="com.atlassian.bamboo.migration.XmlMigrator">
        <property name="bootstrapManager" ref="bootstrapManager"/>
        <property name="persister" ref="persister"/>
        <property name="sessionFactory" ref="sessionFactory"/>
        <property name="cacheManager" ref="cacheManager"/>
        <property name="schemaHelper" ref="schemaHelper"/>
        <property name="resetableHiLoGeneratorHelper" ref="resetableHiLoGeneratorHelper" />
        <property name="applicationConfig" ref="applicationConfig" />
        <property name="upgradeUtilityBean" ref="upgradeUtilityBean" />

        <property name="exporters">
          <list>
            <ref bean="userMapper" />
            <ref bean="groupMapper" />
            <ref bean="authorMapper" />
            <ref bean="trustedApplicationsMapper"/>
            <ref bean="labelMapper" />
            <ref bean="elasticImageConfigurationMapper" />
            <ref bean="pipelineMapper" />
            <ref bean="sharedCapabilityMapper" />
            <ref bean="jiraServerMapper" />
            <ref bean="instantMessagingServerMapper" />
            <ref bean="mailServerMapper" />
            <ref bean="elasticInstanceScheduleMapper" />
            <ref bean="projectMapper" />
            <ref bean="projectDependencyMapper" />
            <ref bean="commitRootMapper" />
            <ref bean="linkedJiraIssueRootMapper" />
            <ref bean="bandanaItemMapper" />
            <ref bean="aclMapper" />
            <ref bean="testClassMapper" />
            <ref bean="testCaseMapper" />
            <ref bean="testClassResultMapper" />
            <ref bean="testCaseResultMapper" />
            <ref bean="testCaseResultErrorMapper" />
            <ref bean="loginInformationMapper" />
            <ref bean="artifactDefinitionMapper" />
            <ref bean="artifactSubscriptionMapper" />
            <ref bean="artifactLinkMapper" />
            <ref bean="consumedSubscriptionMapper" />
            <ref bean="auditLogMapper" />
            <ref bean="variableDefinitionMapper" />
            <ref bean="variableSubstitutionMapper" />
          </list>
        </property>

        <property name="headerImporters">
          <list>
            <ref bean="buildNumberMapper" />
            <ref bean="serverIdMapper" />
          </list>
        </property>

        <property name="importers">
          <list>
            <ref bean="userMapper" />
            <ref bean="groupMapper" />
            <ref bean="authorMapper" />
            <ref bean="trustedApplicationsMapper"/>
            <ref bean="labelMapper" />
            <ref bean="elasticImageConfigurationMapper" />
            <ref bean="pipelineMapper" />
            <ref bean="sharedCapabilityMapper" />
            <ref bean="jiraServerMapper" />
            <ref bean="instantMessagingServerMapper" />
            <ref bean="mailServerMapper" />
            <ref bean="elasticInstanceScheduleMapper" />
            <ref bean="projectMapper" />
            <ref bean="projectBuildMapper" />
            <ref bean="projectChainMapper" />
            <ref bean="projectDependencyMapper" />
            <ref bean="legacyProjectDependencyMapper" />
            <ref bean="commitRootMapper" />
            <ref bean="linkedJiraIssueRootMapper" />
            <ref bean="bandanaItemMapper" />
            <ref bean="aclMapper" />
            <ref bean="testClassMapper" />
            <ref bean="testCaseMapper" />
            <ref bean="testClassResultMapper" />
            <ref bean="testCaseResultMapper" />
            <ref bean="testCaseResultErrorMapper" />
            <ref bean="loginInformationMapper" />
            <ref bean="artifactDefinitionMapper" />
            <ref bean="artifactSubscriptionMapper" />
            <ref bean="artifactLinkMapper" />
            <ref bean="consumedSubscriptionMapper" />
            <ref bean="auditLogMapper" />
            <ref bean="variableDefinitionMapper" />
            <ref bean="variableSubstitutionMapper" />
          </list>
        </property>
      </bean>
    </property>
  </bean>

  <bean id="importExportManager" class="com.atlassian.bamboo.migration.ImportExportManagerImpl">
    <constructor-arg ref="deletionService"/>
    <constructor-arg ref="xmlMigrator" />
    <constructor-arg ref="textProvider" />
    <constructor-arg ref="adminErrorHandler" />
  </bean>  

  <bean id="artifactDefinitionMapper" class="com.atlassian.bamboo.migration.stream.ArtifactDefinitionMapper">
    <constructor-arg ref="sessionFactory"/>
    <constructor-arg ref="artifactDefinitionDao"/>
    <constructor-arg ref="planManager"/>
  </bean>

  <bean id="artifactLinkMapper" class="com.atlassian.bamboo.build.artifact.ArtifactLinkMapper">
    <constructor-arg ref="sessionFactory"/>
    <constructor-arg ref="artifactLinkDao"/>
    <constructor-arg ref="buildResultsSummaryManager"/>
  </bean>

  <bean id="artifactSubscriptionMapper" class="com.atlassian.bamboo.migration.stream.ArtifactSubscriptionMapper">
    <constructor-arg ref="sessionFactory"/>
    <constructor-arg ref="artifactDefinitionDao"/>
    <constructor-arg ref="artifactSubscriptionDao"/>
    <constructor-arg ref="planManager"/>
  </bean>

  <bean id="auditLogMapper" class="com.atlassian.bamboo.migration.stream.AuditLogMapper">
    <constructor-arg ref="sessionFactory"/>
    <constructor-arg ref="auditLogDao"/>
  </bean>

  <bean id="authorMapper" class="com.atlassian.bamboo.migration.stream.AuthorMapper">
    <constructor-arg ref="sessionFactory"/>
    <constructor-arg ref="extendedAuthorManager"/>
  </bean>

  <bean id="buildNumberMapper" class="com.atlassian.bamboo.migration.stream.BuildNumberMapper">
    <constructor-arg ref="sessionFactory"/>
    <constructor-arg ref="applicationConfig"/>
  </bean>

  <bean id="consumedSubscriptionMapper" class="com.atlassian.bamboo.migration.stream.ConsumedSubscriptionMapper">
    <constructor-arg ref="sessionFactory"/>
    <constructor-arg ref="consumedSubscriptionDao"/>
    <constructor-arg ref="artifactLinkDao"/>
    <constructor-arg ref="buildResultsSummaryManager"/>
  </bean>

  <bean id="groupMapper" class="com.atlassian.bamboo.migration.stream.GroupMapper">
    <constructor-arg ref="sessionFactory"/>
    <constructor-arg ref="bambooUserManager"/>
  </bean>

  <bean id="loginInformationMapper" class="com.atlassian.bamboo.migration.stream.LoginInformationMapper">
    <constructor-arg ref="sessionFactory"/>
    <constructor-arg ref="loginInformationManager"/>
  </bean>

  <bean id="serverIdMapper" class="com.atlassian.bamboo.migration.stream.ServerIDMapper">
    <constructor-arg ref="sessionFactory"/>
    <constructor-arg ref="bootstrapManager"/>
  </bean>

  <bean id="testClassMapper" class="com.atlassian.bamboo.resultsummary.tests.TestClassMapper">
    <constructor-arg ref="sessionFactory"/>
    <constructor-arg ref="planDao"/>
    <constructor-arg ref="testsDao"/>
  </bean>

  <bean id="testCaseMapper" class="com.atlassian.bamboo.resultsummary.tests.TestCaseMapper">
    <constructor-arg ref="sessionFactory"/>
    <constructor-arg ref="testsDao"/>
  </bean>

  <bean id="testClassResultMapper" class="com.atlassian.bamboo.resultsummary.tests.TestClassResultMapper">
    <constructor-arg ref="sessionFactory"/>
    <constructor-arg ref="testResultsDao"/>
  </bean>

  <bean id="testCaseResultMapper" class="com.atlassian.bamboo.resultsummary.tests.TestCaseResultMapper">
    <constructor-arg ref="sessionFactory"/>
    <constructor-arg ref="testResultsDao"/>
  </bean>

  <bean id="testCaseResultErrorMapper" class="com.atlassian.bamboo.resultsummary.tests.TestCaseResultErrorMapper">
    <constructor-arg ref="sessionFactory"/>
    <constructor-arg ref="testResultsDao"/>
  </bean>

  <bean id="userMapper" class="com.atlassian.bamboo.migration.stream.UserMapper">
    <constructor-arg ref="sessionFactory"/>
    <constructor-arg ref="bambooUserManager"/>
  </bean>

  <bean id="trustedApplicationsMapper" class="com.atlassian.bamboo.migration.stream.TrustedApplicationsMapper">
    <constructor-arg ref="sessionFactory"/>
    <constructor-arg ref="bambooTrustedApplicationsHibernateDao"/>
  </bean>

  <bean id="labelMapper" class="com.atlassian.bamboo.migration.stream.LabelMapper">
    <constructor-arg ref="sessionFactory"/>
    <constructor-arg ref="labelDao"/>
  </bean>

  <bean id="elasticImageConfigurationMapper" class="com.atlassian.bamboo.migration.stream.ElasticImageConfigurationMapper">
    <constructor-arg ref="sessionFactory"/>
    <constructor-arg ref="elasticImageConfigurationAccessor"/>
    <constructor-arg ref="capabilitySetManager"/>
  </bean>

  <bean id="pipelineMapper" class="com.atlassian.bamboo.migration.stream.PipelineMapper">
    <constructor-arg ref="sessionFactory"/>
    <constructor-arg ref="capabilitySetManager"/>
    <constructor-arg ref="elasticImageConfigurationAccessor"/>
    <constructor-arg ref="localAgentManager"/>
  </bean>

  <bean id="sharedCapabilityMapper" class="com.atlassian.bamboo.migration.stream.SharedCapabilityMapper">
    <constructor-arg ref="sessionFactory"/>
    <constructor-arg ref="localCapabilityDao"/>
    <constructor-arg ref="remoteCapabilityDao"/>
  </bean>

  <bean id="jiraServerMapper" class="com.atlassian.bamboo.migration.stream.JiraServerMapper">
    <constructor-arg ref="sessionFactory"/>
    <constructor-arg ref="jiraServerManager"/>
  </bean>

  <bean id="instantMessagingServerMapper" class="com.atlassian.bamboo.migration.stream.InstantMessagingServerMapper">
    <constructor-arg ref="sessionFactory"/>
    <constructor-arg ref="instantMessagingServerManager"/>
  </bean>

  <bean id="mailServerMapper" class="com.atlassian.bamboo.migration.stream.MailServerMapper">
    <constructor-arg ref="sessionFactory"/>
  </bean>

  <bean id="elasticInstanceScheduleMapper" class="com.atlassian.bamboo.migration.stream.ElasticInstanceScheduleMapper">
    <constructor-arg ref="sessionFactory"/>
    <constructor-arg ref="elasticInstanceScheduleDao"/>
    <constructor-arg ref="elasticImageConfigurationDao"/>
  </bean>

  <bean id="projectMapper" class="com.atlassian.bamboo.migration.stream.ProjectMapper">
    <constructor-arg ref="sessionFactory"/>
    <constructor-arg ref="projectManager"/>
    <constructor-arg ref="buildResultsSummaryManager"/>
    <constructor-arg ref="extendedAuthorManager"/>
    <constructor-arg ref="labelDao"/>
    <constructor-arg ref="notificationManager"/>
    <constructor-arg ref="planManager"/>
    <constructor-arg ref="buildResultsSummaryDao"/>
  </bean>

  <bean id="projectBuildMapper" class="com.atlassian.bamboo.migration.stream.ProjectBuildMapper">
    <constructor-arg ref="sessionFactory"/>
    <constructor-arg ref="projectManager"/>
    <constructor-arg ref="buildResultsSummaryManager"/>
    <constructor-arg ref="extendedAuthorManager"/>
    <constructor-arg ref="labelDao"/>
    <constructor-arg ref="notificationManager"/>
    <constructor-arg ref="planManager"/>
    <constructor-arg ref="buildResultsSummaryDao"/>
  </bean>

  <bean id="projectChainMapper" class="com.atlassian.bamboo.migration.stream.ProjectChainMapper">
    <constructor-arg ref="sessionFactory"/>
    <constructor-arg ref="projectManager"/>
    <constructor-arg ref="buildResultsSummaryManager"/>
    <constructor-arg ref="extendedAuthorManager"/>
    <constructor-arg ref="labelDao"/>
    <constructor-arg ref="notificationManager"/>
    <constructor-arg ref="planManager"/>
    <constructor-arg ref="buildResultsSummaryDao"/>
  </bean>

  <bean id="projectDependencyMapper" class="com.atlassian.bamboo.migration.stream.ProjectDependencyMapper">
    <constructor-arg ref="sessionFactory"/>
    <constructor-arg ref="planManager"/>
    <constructor-arg ref="planDependencyManager"/>
  </bean>

  <bean id="legacyProjectDependencyMapper" class="com.atlassian.bamboo.migration.stream.LegacyProjectDependencyMapper">
    <constructor-arg ref="sessionFactory"/>
    <constructor-arg ref="planManager"/>
    <constructor-arg ref="planDependencyManager"/>
  </bean>

  <bean id="commitRootMapper" class="com.atlassian.bamboo.migration.stream.CommitRootMapper">
    <constructor-arg ref="sessionFactory"/>
    <constructor-arg ref="commitDao"/>
    <constructor-arg ref="extendedAuthorManager"/>
  </bean>

  <bean id="linkedJiraIssueRootMapper" class="com.atlassian.bamboo.migration.stream.LinkedJiraIssueRootMapper">
    <constructor-arg ref="sessionFactory"/>
    <constructor-arg ref="buildResultsSummaryDao"/>
  </bean>

  <bean id="bandanaItemMapper" class="com.atlassian.bamboo.migration.stream.BandanaItemMapper">
    <constructor-arg ref="sessionFactory"/>
    <constructor-arg ref="bandanaItemDao"/>
  </bean>
  <bean id="aclMapper" class="com.atlassian.bamboo.migration.stream.AclMapper">
    <constructor-arg ref="sessionFactory"/>
    <constructor-arg ref="aclDao"/>
  </bean>

  <bean id="variableDefinitionMapper" class="com.atlassian.bamboo.migration.stream.VariableDefinitionMapper">
    <constructor-arg ref="sessionFactory"/>
    <constructor-arg ref="variableDefinitionDao"/>
    <constructor-arg ref="planManager"/>
  </bean>

  <bean id="variableSubstitutionMapper" class="com.atlassian.bamboo.migration.stream.VariableSubstitutionMapper">
    <constructor-arg ref="sessionFactory"/>
    <constructor-arg ref="buildResultsSummaryDao"/>
  </bean>
</beans>