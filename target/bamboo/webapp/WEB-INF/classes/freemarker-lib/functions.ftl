[#function hasPlanPermission permission plan]
    [#return action.hasPlanPermission(permission, plan)]
[/#function]

[#function hasGlobalPermission permission]
     [#if ctx?has_content]
        [#return ctx.hasGlobalPermission(permission)]
     [#else]
        [#return action.hasGlobalPermission(permission)]
     [/#if]
[/#function]

[#function hasGlobalAdminPermission]
    [#if ctx?has_content]
        [#return ctx.hasGlobalAdminPermission()]
     [#else]
        [#return action.hasGlobalAdminPermission()]
    [/#if]
[/#function]

[#function hasRestrictedAdminPermission]
    [#if ctx?has_content]
        [#return ctx.hasRestrictedAdminPermission()]
    [#else]
        [#return action.hasRestrictedAdminPermission()]
    [/#if]
[/#function]

[#function hasAdminPermission]
    [#if ctx?has_content]
        [#return ctx.hasAdminPermission()]
    [#else]
        [#return action.hasAdminPermission()]
    [/#if]
[/#function]

[#function getUserFullName user='']
    [#if user?has_content]
        [#if user.fullName?has_content]
            [#return user.fullName]
        [#else]
            [#if user.name?has_content]
                [#return user.name]
            [#else]
                [#return "Name Unknown"]
            [/#if]
        [/#if]
    [#else]
        [#return "Anonymous User"]
    [/#if]
[/#function]

[#function getAuthorFullName author='']
    [#if author?has_content]
        [#if author.fullName?has_content]
            [#return author.fullName]
        [#else]
            [#if author.name?has_content]
                [#return author.name]
            [#else]
                [#return "[unknown]"]
            [/#if]
        [/#if]
    [#else]
        [#return "[unknown]"]
    [/#if]
[/#function]

[#function sanitizeUri uri]
    [#return uri?replace("[\"'<>\\\\]", "", "r")]
[/#function]


[#-- ================================================================================================= @ui.getTestCaseResultUrl --]
[#function getTestCaseResultUrl buildKey buildNumber testCaseId]
    [#return "/browse/${buildKey}-${buildNumber}/test/case/${testCaseId}"]
[/#function]
[#-- ================================================================================================= @ui.getViewTestCaseHistoryUrl --]
[#function getViewTestCaseHistoryUrl buildKey testCaseId]
    [#return "/browse/${buildKey}/test/case/${testCaseId}" ]
[/#function]

[#function getPlanEditLink build]
    [#if build.type != "CHAIN"]
        [#return "${req.contextPath}/build/admin/edit/editBuildConfiguration.action?buildKey=${build.key}"]
    [#else]
        [#return "${req.contextPath}/chain/admin/config/editChainConfiguration.action?buildKey=${build.key}"]
    [/#if]
[/#function]

[#function getPlanRunLink build]
    [#return "${req.contextPath}/build/admin/triggerManualBuild.action?buildKey=${build.key}"]
[/#function]

[#function getPlanStopLink build]
    [#return "${req.contextPath}/build/admin/ajax/stopPlan.action?planKey=${build.key}"]
[/#function]
